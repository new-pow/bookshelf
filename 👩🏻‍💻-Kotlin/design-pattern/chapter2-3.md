# 싱글톤
- 싱글톤
	- 서비스 전체 라이프 사이클에서 인스ㄴ스가 1개 계속 생존해야 하는 경우
	- 상태를 갖지 않게 하거나 동시성에 대한 대비를 할 것
	- 순수한 기능만 제공하는 경우 상태로 연결되어 있지 않은 기능을 꼭 싱글톤으로 묶어야 하는지 고민해볼것
- 싱긅톤이 필요한 상황에서 정해진 갯수의 인스턴스가 생존해야 하는 경우 Enum을 사용합니다.
- JVM 플랫폼에서 원천적으로 안전한 싱글톤 객체 는 Enum
- 코틀린의 경우 object 키워드가 많은 것을 자동화한다.
	- 인스턴스이자 타입임
	- 전역 수준에 선언된 변수와 함수도 전부 싱글톤
- 코틀린은 상대적으로 싱글톤을 남발하기 쉬우므로 class 로 선언하는 것을추천한다.

# 팩토리 메서드
- 타입은 모든걸 규정할 수 있지만 유일하게 불가능한 것이 생성자임.
- 생성법을 추상화할 필요가 있음
- `KfunctionX` 이용법
- **코틀린 리플렉션**
	- 2단계 컴파일러
		- 프론트엔드 컴파일 -> 백엔드 컴파일
		- 프론트엔드 컴파일링 하고나서 구조적인 리플렉션 객체들을 만들 수 있음.
- KFunctionX
	- `::class` 생성자 함수로 치환할 수 있다
	- 같은 시그니처 생성자를 정의하여 추상화할 수 있다.
	- `Kclass` 맵으로 팩토리 라우팅 구현 가능
- 모든 Kfunction 마지막은 `out` 타입임
![[Pasted image 20240711222323.png]]
- 정적 팩토리 메서드
	- 거의 필수
	- 코틀린 생성자는 일반 함수에 비해 2가지 제약 조건이 있다
		- `suspend` 로 생성할 수 없음. 즉 비동기적인 생성자를 쓸 수 없음
		- `refied` 제네릭을 사용할 수 없음
		- 이 제약들을 피하려면 정적 팩토리를 제공하는 수 밖에 없음

# 추상팩토리메소드
- 어떤 객체를 생성할 때 의존성 있는 다른 객체도 생성해야만 만들어낼 수 있는 경우가 있음
	- 객체지향은 독립된 객체 간의 의존성으로 객체망구성
	- 의존관계 객체 사이에 라이프사이클 문제
	- 다른 라이프사이클을 가지는 것들을 조화롭게 할 수 있는 특단의 조치가 필요하다.
	- 생성하려는 객체의 타입에 맞춰 의존 객체도 달라질 수 있음
	- 경우에 따라 팩토리만으로 안되고 DI로 발전되기도 함
		- 코틀린 DI 엄청 복잡함.
- 추상 팩토리메소드는 1번의 모든 내용을 추상화하는 것
- 빌더
	- 모든 팩토리 계열의 패턴은 결국 빌더로 통합됨
- 대부분의 객체 생성 시
	- 속성 설정 - 밸리데이션 등이 관여하여 정합성을 검사해야함
	- 의존객체 - 그 객체를 얻는 방법, 라이프사이클을 맞추는 법 등
	- 절차 - 순서를 강제하는 것은 매우 어려운 일
- 빌더란
	- 복잡한 헬퍼 객체를 동원해 통해 이를 컴파일시에 어길 수 없게 디자인하는 모든 것
- `value class` 실체가 될타입으로 바꿔줌
- DLS 객체
	- 컴파일된 코드 보면 타입이 아예 없어짐
![[Pasted image 20240711225244.png]]

# 데코레이터 ✨
- 기능을 추상화하여 인터페이스를 생성함
- 런타임에 일어나는 패턴
- 추상화된 기능을 개별 타입이 구현함
- 어차피 비슷한 일을 추상화한 것이므로 하나의 일을 비슷한 객체끼리 해야할 일만 하고 나눠서 하는 식으로 사고할 수 있음
- 결국 어떤 도메인을 협력할 수 있는 작업으로 나눌 수 있고 그 작업들을 관통하는 추상화(일반화)를 할 수 있다면 데코레이터 패턴을 쓸 수 있음
- 대부분 데코레이터의 쓰임
	- 큰 결과물이 있어서 참여자가 나름대로 기여하는 기여모델
	- stream, rx, flux, flow
	- plugin
	- 자기가 해보고 아니면 패스하는 게이트 모델

# 브릿지
- 합성을 통해 상속조합 폭발을 피함
- 하나의 객체가 다수의 합성 객체로 표현되는 경우
	- 해당 객체는 여러 객체를 모아둔 일종의 집합객체임 ggregation
	- 특히 각 객체가 서로 침범하지 않는 경우 유용함
	- 복잡한 상호작용을 한다면 외부에 인터페이스를 노출하지 않는 퍼사드라고 할 수 있음
- 코틀린은 인터페이스 위임으로 간단히 해결됨
	- 어셈블인 애들은 브릿지가 가능함.
	- 소유권에 대한 문제임
![[Pasted image 20240711232147.png]]

